<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Unsigned Tx Signer</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.12.1/dist/ethers.umd.min.js"></script>
  </head>
  <body>
    <h2>Unsigned Ethereum Transaction Signer</h2>
    <textarea id="txInput" rows="20" cols="80" placeholder="Paste unsigned tx JSON here"></textarea><br>
    <button id="signBtn">Send to Wallet</button>

    <script>
      const btn = document.getElementById("signBtn");
      btn.onclick = async () => {
        try {
          if (!window.ethereum) {
            alert("No injected wallet (MetaMask, Rabby) found.");
            return;
          }

          const provider = new ethers.BrowserProvider(window.ethereum);
          const signer = await provider.getSigner();

          const tx = JSON.parse(document.getElementById("txInput").value);

          // Ethers expects BigInt for numbers
          if (tx.value) tx.value = BigInt(tx.value);

          console.log("Sending to wallet:", tx);
          const response = await signer.sendTransaction(tx);

          alert("Transaction sent! Hash: " + response.hash);
        } catch (err) {
          console.error(err);
          alert("Error: " + err.message);
        }
      };
    </script>
  </body>
</html>
